/*!build time : 2014-08-12 12:03:36 AM*/
KISSY.add("kg/textbox/2.0.5/numberUtils",function(a,b){var c={},d=c;return c.format=function(a,b){var c=a;if(b=b||"-",/^1\d{10}$/.test(a)){var d=a.match(/^(\d{3})(\d{4})(\d{4})$/);c=d[1]+b+d[2]+b+d[3]}else if(/^0\d{9,11}$/.test(a)){var e=this.getDistrictNumber(a);""!==e&&(c=e+b+a.substring(e.length))}return c},c.format2=function(a,b){var c="",d=a.length;return b=b||"-","1"==a.charAt(0)?(4>d?c=a:(c=a.substring(0,3),c+=8>d?"-"+a.substring(3,d):"-"+a.substring(3,7)+"-"+a.substring(7,d)),(3==d||7==d)&&(c+="-")):c="0"==a.charAt(0)?2>=d?a:/^0(10|2([0-5]||[7-9]))/.test(a)?a.substring(0,3)+"-"+a.substring(3,d):a.length<4?a:a.substring(0,4)+"-"+a.substring(4,d):a,c},c.getDistrictNumber=function(a){var b="";return/^0\d{9,11}$/.test(a)&&(b=/^0(10|2([0-5]||[7-9]))/.test(a)?a.substring(0,3):a.substring(0,4)),b},c.getProvince=function(b){var c="";if(a.isString(b)&&/^0[1-9]\d{2}/.test(b))switch(b.substring(1,3)){case"10":c="\u5317\u4eac";break;case"21":c="\u4e0a\u6d77";break;case"22":c="\u5929\u6d25";break;case"23":c="\u91cd\u5e86";break;case"24":c="\u8fbd\u5b81";break;case"25":c="\u6c5f\u82cf";break;case"27":c="\u6e56\u5317";break;case"28":c="\u56db\u5ddd";break;case"29":c="\u9655\u897f";break;case"20":c="\u5e7f\u4e1c";break;case"31":case"32":case"33":c="\u6cb3\u5317";break;case"34":case"35":c="\u5c71\u897f";break;case"37":case"38":case"39":c="\u6cb3\u5357";break;case"41":case"42":c="\u8fbd\u5b81";break;case"43":case"44":c="\u5409\u6797";break;case"45":case"46":c="\u9ed1\u9f99\u6c5f";break;case"47":case"48":c="\u5185\u8499\u53e4";break;case"51":case"52":c="\u6c5f\u82cf";break;case"53":case"54":case"63":c="\u5c71\u4e1c";break;case"55":case"56":c="\u5b89\u5fbd";break;case"57":case"58":c="\u6d59\u6c5f";break;case"59":c="\u798f\u5efa";break;case"71":case"72":c="\u6e56\u5317";break;case"73":case"74":c="\u6e56\u5357";break;case"75":case"76":case"66":c="\u5e7f\u4e1c";break;case"77":c="\u5e7f\u897f";break;case"79":case"70":c="\u6c5f\u897f";break;case"81":case"82":case"83":c="\u6c5f\u897f";break;case"85":c="\u8d35\u5dde";break;case"87":case"88":case"69":c="\u4e91\u5357";break;case"89":c="8"===b.charAt(3)?"\u6d77\u5357":"\u897f\u85cf";break;case"91":c="\u9655\u897f";break;case"93":case"94":c="\u7518\u8083";break;case"95":c="\u5b81\u590f";break;case"97":c="\u9752\u6d77";break;case"99":case"90":c="\u65b0\u7586"}return c},c.NUMBER_TYPE={UNKNOWN:0,TEL:1,FIXED:2,ARR:[0,1,2]},c.VALIDATION_RESULT_TYPE={VALID:0,MISSING:1,MISMATCH:2,UNSUPPORTED:3},c.isFixedNumber=function(a){return/^(0\d{9,11})$/.test(a)},c.isTelNumber=function(a){return/^(1\d{10})$/.test(a)},c._getCarrierStr=function(a){var b=a.match(/\u79fb\u52a8|\u8054\u901a|\u7535\u4fe1/);return b&&b[0]||""},c._numberInfoCache={},c._tccUrlBase=a.substitute("http://{hostname}/cc/json/mobile_tel_segment.htm",{hostname:/assets\.daily\.taobao\.net/.test(a.Config.base)?"tcc.daily.taobao.net":"tcc.taobao.com"}),c.getNumberInfo=function(c,d,e){var f,g,h=this;a.log("[number-utils]start to get info of "+c),/^\d+$/.test(c)&&(a.log("[number-utils]number is valid"),a.log("[number-utils]check cache"),f=this._numberInfoCache[c],f?(a.log("[number-utils]cache is found"),1==f.code?d(f):e(f)):(a.log("[number-utils]no cache"),f={},"1"==c.charAt(0)?(a.log("[number-utils]it's a telephone number, get its info from remote server"),b({url:this._tccUrlBase,dataType:"script",scriptCharset:"gbk",data:{tel:c},cache:!1,timeout:5,error:function(){a.log("[number-utils]error happens during requesting, make the info unknown"),f.msg="\u53f7\u7801\u4fe1\u606f\u672a\u77e5",f.code=-1,a.isFunction(e)&&e(f)},success:function(){var b=window.__GetZoneResult_;f.msg="",b.telString?(a.log("[number-utils]info: "+b.province+", "+h._getCarrierStr(b.catName)),f.code=1,a.mix(f,{carrier:h._getCarrierStr(b.catName),area:b.province,number:c}),a.log("[number-utils]caching..."),h._numberInfoCache[c]=f,a.isFunction(d)&&d(f)):(f.code=-1,a.log("[number-utils]the info remains unknown"),f.error="\u53f7\u7801\u4fe1\u606f\u672a\u77e5",a.log("[number-utils]caching..."),h._numberInfoCache[c]=f,a.isFunction(e)&&e(f))}})):(a.log("[number-utils]it's a fixed number, try to guess its area info"),g=h.getProvince(c),""!=g?(a.mix(f,{carrier:"\u56fa\u8bdd",area:g,number:c}),h._numberInfoCache[c]=f,a.isFunction(d)&&d(f)):(f.error="\u53f7\u7801\u4fe1\u606f\u672a\u77e5",h._numberInfoCache[c]=f,a.isFunction(e)&&e(infoObj)))))},c.NUMBER_HELPER_CONTENT_FN={SIMPLE:function(a){return this.format(a)},ADVANCED:function(b){var c=a.substitute('<p class="{prefixCls}number">{number}</p>',{number:this.format(b),prefixCls:this.get("prefixCls")+"helper-"});c+=d.isTelNumber(b)?this.get("accept")==d.NUMBER_TYPE.FIXED?'<p class="{prefixCls}tip">\u8bf7\u8f93\u5165\u56fa\u5b9a\u7535\u8bdd\u53f7\u7801</p>':'<p class="{prefixCls}tip">\u624b\u673a\u53f7\u662f11\u4f4d\u6570\u5b57</p>':this.get("accept")==d.NUMBER_TYPE.TEL?'<p class="{prefixCls}tip">\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801</p>':'<p class="{prefixCls}tip">\u5c0f\u7075\u901a\u6216\u56fa\u8bdd\u970010-12\u4f4d</p>'}},c.getMaxLength=function(b,c){var d;return a.isNumber(b)&&a.inArray(b,this.NUMBER_TYPE.ARR)&&(d=a.isString(c)&&""!=c?"0"==c.charAt(0)&&b!=this.NUMBER_TYPE.TEL?12:11:b==this.NUMBER_TYPE.FIXED?12:11),d},c.validate=function(a,b){return this._analyze(a,b).validationResultType},c.getNumberType=function(a,b){return this._analyze(a,b).numberType},c._analyze=function(b,c){var d={validationResultType:this.VALIDATION_RESULT_TYPE.VALID,numberType:this.NUMBER_TYPE.UNKNOWN};return b||(b=this.NUMBER_TYPE.UNKNOWN),a.isString(c)&&""!=c?b==this.NUMBER_TYPE.TEL?/^1\d{10}$/.test(c)?d.numberType=this.NUMBER_TYPE.TEL:d.validationResultType=/^0/.test(c)?this.VALIDATION_RESULT_TYPE.UNSUPPORTED:this.VALIDATION_RESULT_TYPE.MISMATCH:b==this.NUMBER_TYPE.FIXED?/^0\d{9,11}$/.test(c)?d.numberType=this.NUMBER_TYPE.FIXED:d.validationResultType=/^1/.test(c)?this.VALIDATION_RESULT_TYPE.UNSUPPORTED:this.VALIDATION_RESULT_TYPE.MISMATCH:/^1\d{10}$/.test(c)?d.numberType=this.NUMBER_TYPE.TEL:/^0\d{9,11}$/.test(c)?d.numberType=this.NUMBER_TYPE.FIXED:d.validationResultType=this.VALIDATION_RESULT_TYPE.MISMATCH:d.validationResultType=this.VALIDATION_RESULT_TYPE.MISSING,d},c},{requires:["ajax"]});